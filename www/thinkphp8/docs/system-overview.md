# 停车场闸机系统 - 系统概述

## 系统简介

停车场闸机系统是一套完整的智能停车场管理解决方案，用于管理停车场的车辆进出、收费计算和数据统计等功能。系统采用现代化的技术架构，结合车牌识别、闸机控制等硬件设备，实现停车场的智能化、自动化管理，提高停车场运营效率，改善用户体验。

## 功能特点

### 1. 停车场管理
- 多停车场管理支持
- 车位实时监控与统计
- 停车场状态管理（开放/关闭）
- 车位占用率实时计算

### 2. 闸机控制
- 入场/出场闸机管理
- 设备状态实时监控
- 远程控制闸机开关
- 设备故障报警

### 3. 车辆管理
- 车辆信息登记与管理
- 多种车辆类型支持（普通车辆、月租车辆、VIP车辆、黑名单车辆）
- 月租车辆管理
- 车辆进出记录查询

### 4. 停车记录
- 车辆进出记录管理
- 停车时长自动计算
- 停车费用自动计算
- 历史记录查询与统计

### 5. 收费管理
- 灵活的收费规则配置
- 多种收费模式（按小时收费、按次收费、阶梯收费）
- 免费时段设置
- 每日最高收费限制

## 系统架构图

```
+----------------------------------+
|           前端应用层              |
|  +-------------+  +------------+ |
|  | 管理员界面  |  | 移动端应用 | |
|  +-------------+  +------------+ |
+----------------------------------+
              |
              | HTTP/WebSocket
              |
+----------------------------------+
|           应用服务层              |
|  +-------------+  +------------+ |
|  | 业务控制器  |  |  服务组件  | |
|  +-------------+  +------------+ |
|  +-------------+  +------------+ |
|  | 数据模型层  |  |  中间件    | |
|  +-------------+  +------------+ |
+----------------------------------+
              |
              | 数据访问
              |
+----------------------------------+
|           数据存储层              |
|  +-------------+  +------------+ |
|  |   MySQL数据库 |  |  Redis缓存 | |
|  +-------------+  +------------+ |
+----------------------------------+
              |
              | 硬件接口
              |
+----------------------------------+
|           硬件设备层              |
|  +-------------+  +------------+ |
|  | 入场闸机设备 |  | 出场闸机设备| |
|  +-------------+  +------------+ |
|  +-------------+  +------------+ |
|  | 车牌识别设备 |  | 收费终端   | |
|  +-------------+  +------------+ |
+----------------------------------+
```

## 系统交互流程

### 车辆入场流程
1. 车辆到达入口闸机
2. 车牌识别设备自动识别车牌
3. 系统查询车辆信息（判断是否为月租车、VIP车辆等）
4. 系统记录入场信息（车牌、时间、入场图片等）
5. 系统更新停车场车位占用情况
6. 闸机自动抬杆放行

### 车辆出场流程
1. 车辆到达出口闸机
2. 车牌识别设备自动识别车牌
3. 系统查询入场记录，计算停车时长
4. 系统根据收费规则计算停车费用
5. 用户完成支付（或系统判断为免费放行）
6. 系统记录出场信息，更新停车记录状态
7. 系统更新停车场车位占用情况
8. 闸机自动抬杆放行

## 技术栈

### 后端技术
- 框架：ThinkPHP 8.0
- 数据库：MySQL
- 缓存：Redis
- 消息队列：Kafka（用于异步处理和设备通信）

### 前端技术
- 管理后台：Vue.js + Element UI
- 移动端：HTML5 + CSS3 + JavaScript

### 硬件接口
- RESTful API
- WebSocket（用于实时数据更新）
- 串口通信（用于闸机控制）

## 系统部署架构

系统采用Docker容器化部署，主要包含以下容器：

- Web应用容器：运行ThinkPHP应用
- MySQL容器：存储系统数据
- Redis容器：提供缓存服务
- Nginx容器：提供Web服务和反向代理
- Kafka容器：提供消息队列服务

容器间通过Docker网络进行通信，保证系统的高可用性和可扩展性。